<html>
<head>
    <title></title>
    <meta charset="utf-8">
    <script type="text/javascript" src="../../thirdparty/require.js"></script>
    <script type="text/javascript" src="../js/config.js"></script>
</head>
<body>
    <canvas id="Main"></canvas>
    <script type="text/javascript">
        require(['qtek/qtek'], function(qtek){
            var qtek2d = qtek['2d'];
            var Path = qtek2d.shape.Path;
            var Vector2 = qtek.math.Vector2;

            var renderer = new qtek2d.CanvasRenderer({
                canvas : document.getElementById("Main"),
                width : 1000,
                height : 600
            });
            var scene = new qtek2d.Scene();

            var path = new Path({
                stroke : true,
                fill : false
            });
            path.position.set(500, 300);
            var points = [];
            for (var i = 0; i < 10000; i++) {
                points.push(new Vector2().random(200))
            }

            path.pushPoints(points);

            console.profile("smooth");
            path.smooth(1);
            console.profileEnd("smooth");

            console.profile("compute bounding box");
            path.computeBoundingBox();
            console.profileEnd("compute bounding box");

            scene.add(path);
            var bb = path.boundingBox;
            scene.add(new qtek2d.shape.Rectangle({
                start : bb.min,
                fill : false,
                stroke : true,
                position : path.position.clone(),
                size : bb.max.clone().sub(bb.min)
            }));

            console.profile("render");
            renderer.render(scene);
            console.profileEnd("render");

            var base = new Vector2(200, 200);
            var p0 = new Vector2().random(100).add(base);
            var p1 = new Vector2().random(100).add(base);
            var p2 = new Vector2().random(100).add(base);
            var bb = {
                min : new Vector2,
                max : new Vector2
            }
            qtek2d.util.computeQuadraticBezierBoundingBox(
                p0, p1, p2,
                bb.min,
                bb.max
            );

            renderer.ctx.beginPath();
            renderer.ctx.moveTo(p0.x, p0.y);
            renderer.ctx.quadraticCurveTo(p1.x, p1.y, p2.x, p2.y);
            renderer.ctx.stroke();
            renderer.ctx.beginPath();
            renderer.ctx.rect(bb.min.x, bb.min.y, bb.max.x-bb.min.x, bb.max.y-bb.min.y);
            renderer.ctx.stroke();

            console.log(bb.min.toString(), bb.max.toString());
        })
        
    </script>
</body>
</html>