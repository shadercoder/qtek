(function(t){"undefined"!=typeof define&&define.amd?define(["exports"],t.bind(window)):t(window.qtek={})})(function(t){var n,e,r;(function(t){function i(t,n){return _.call(t,n)}function a(t,n){var e,r,i,a,o,u,s,c,l,f,h=n&&n.split("/"),d=y.map,p=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(n){for(h=h.slice(0,h.length-1),t=h.concat(t.split("/")),c=0;t.length>c;c+=1)if(f=t[c],"."===f)t.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((h||p)&&d){for(e=t.split("/"),c=e.length;c>0;c-=1){if(r=e.slice(0,c).join("/"),h)for(l=h.length;l>0;l-=1)if(i=d[h.slice(0,l).join("/")],i&&(i=i[r])){a=i,o=c;break}if(a)break;!u&&p&&p[r]&&(u=p[r],s=c)}!a&&u&&(a=u,o=s),a&&(e.splice(0,o,a),t=e.join("/"))}return t}function o(n,e){return function(){return d.apply(t,b.call(arguments,0).concat([n,e]))}}function u(t){return function(n){return a(n,t)}}function s(t){return function(n){g[t]=n}}function c(n){if(i(m,n)){var e=m[n];delete m[n],x[n]=!0,h.apply(t,e)}if(!i(g,n)&&!i(x,n))throw Error("No "+n);return g[n]}function l(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function f(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,d,p,v,g={},m={},y={},x={},_=Object.prototype.hasOwnProperty,b=[].slice;p=function(t,n){var e,r=l(t),i=r[0];return t=r[1],i&&(i=a(i,n),e=c(i)),i?t=e&&e.normalize?e.normalize(t,u(n)):a(t,n):(t=a(t,n),r=l(t),i=r[0],t=r[1],i&&(e=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:e}},v={require:function(t){return o(t)},exports:function(t){var n=g[t];return n!==void 0?n:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},h=function(n,e,r,a){var u,l,f,h,d,y,_=[];if(a=a||n,"function"==typeof r){for(e=!e.length&&r.length?["require","exports","module"]:e,d=0;e.length>d;d+=1)if(h=p(e[d],a),l=h.f,"require"===l)_[d]=v.require(n);else if("exports"===l)_[d]=v.exports(n),y=!0;else if("module"===l)u=_[d]=v.module(n);else if(i(g,l)||i(m,l)||i(x,l))_[d]=c(l);else{if(!h.p)throw Error(n+" missing "+l);h.p.load(h.n,o(a,!0),s(l),{}),_[d]=g[l]}f=r.apply(g[n],_),n&&(u&&u.exports!==t&&u.exports!==g[n]?g[n]=u.exports:f===t&&y||(g[n]=f))}else n&&(g[n]=r)},n=e=d=function(n,e,r,i,a){return"string"==typeof n?v[n]?v[n](e):c(p(n,e).f):(n.splice||(y=n,e.splice?(n=e,e=r,r=null):n=t),e=e||function(){},"function"==typeof r&&(r=i,i=a),i?h(t,n,e,r):setTimeout(function(){h(t,n,e,r)},4),d)},d.config=function(t){return y=t,y.deps&&d(y.deps,y.callback),d},r=function(t,n,e){n.splice||(e=n,n=[]),i(g,t)||i(m,t)||(m[t]=[t,n,e])},r.amd={jQuery:!0}})(),r("build/almond",function(){}),r("2d/camera",function(){}),r("core/mixin/derive",[],function(){function t(t,n,e){"object"==typeof n&&(e=n,n=null);var r={"instanceof":function(t){for(var n=a;n;){if(n===t)return!0;n=n.__super__}}},i=this,a=function(e){if(i.call(this),_.extend(this,"function"==typeof t?t.call(this):t),_.extend(this,e),this.constructor==a){for(var r=a,o=[n];r.__super__;)r=r.__super__,o.unshift(r.__initialize__);for(var u=0;o.length>u;u++)o[u]&&o[u].call(this)}};return a.__super__=i,a.__initialize__=n,_.extend(a.prototype,i.prototype,r,e),a.prototype.constructor=a,a.derive=i.derive,a}return{derive:t}}),r("core/mixin/notifier",[],function(){return{trigger:function(){if(this.__handlers__){var t=arguments[0],n=Array.prototype.slice.call(arguments,1),e=this.__handlers__[t];if(e)for(var r=0;e.length>r;r+=2){var i=e[r],a=e[r+1];i.apply(a||this,n)}}},on:function(t,n,e){if(t){var r=this.__handlers__||(this.__handlers__={});return r[t]||(r[t]=[]),-1==r[t].indexOf(n)&&(r[t].push(n),r[t].push(e)),n}},off:function(t,n){var e=this.__handlers__||(this.__handlers__={});if(e[t])if(n){var r=e[t],i=r.indexOf(n);i>=0&&r.splice(i,2)}else e[t]=[]},has:function(t,n){return this.__handlers__&&this.__handlers__[t]?n?-1!==this.__handlers__[t].indexOf(n):this.__handlers__[t].length:!1}}}),r("core/mixin/dirty",{dirty:function(t){this._dirtyFlag||(this._dirtyFlag={}),this._dirtyFlag[t]=!0},fresh:function(t){this._dirtyFlag||(this._dirtyFlag={}),this._dirtyFlag[t]=!1},isDirty:function(t){return this._dirtyFlag||(this._dirtyFlag={}),this._dirtyFlag[t]===void 0?!0:this._dirtyFlag[t]}}),r("core/cache",[],function(){var t=function(){this._contextId="",this._caches={},this._context={}};return t.prototype={use:function(t,n){if(!this._caches.hasOwnProperty(t)&&(this._caches[t]={},n))for(var e in n)this._caches[t][e]=n[e];this._contextId=t,this._context=this._caches[t]},put:function(t,n){this._context[t]=n},get:function(t){return this._context[t]},clearContext:function(){this._caches[this._contextId]={},this._context={}},"delete":function(t){delete this._context[t]},clearAll:function(){this._caches={}},getContext:function(){return this._context},miss:function(t){return!this._context.hasOwnProperty(t)}},t.prototype.constructor=t,t}),function(t){function n(r){function i(t){return t&&"object"==typeof t&&!_r(t)&&Ke.call(t,"__wrapped__")?t:new N(t)}function o(t,n,e){var r=t.length,i=r-n>=e;if(i)for(var a={},o=n-1;r>++o;){var u=Fe(t[o]);(Ke.call(a,u)?a[u]:a[u]=[]).push(t[o])}return function(e){if(i){var r=Fe(e);return Ke.call(a,r)&&Vn(a[r],e)>-1}return Vn(t,e,n)>-1}}function S(t){return t.charCodeAt(0)}function E(t,n){var r=t.index,i=n.index;if(t=t.criteria,n=n.criteria,t!==n){if(t>n||t===e)return 1;if(n>t||n===e)return-1}return i>r?-1:1}function R(t,n,e,r){function i(){var r=arguments,c=o?this:n;if(a||(t=n[u]),e.length&&(r=r.length?(r=V(r),s?r.concat(e):e.concat(r)):e),this instanceof i){W.prototype=t.prototype,c=new W,W.prototype=null;var l=t.apply(c,r);return cn(l)?l:c}return t.apply(c,r)}var a=sn(t),o=!e,u=n;if(o){var s=r;e=n}else if(!a){if(!r)throw new Xe;n=t}return i}function H(){for(var t,n={shadowedProps:b,arrays:"isArray(iterable)",bottom:"",init:"iterable",loop:"",top:"",useHas:!0,useKeys:!!Ar},e=0;t=arguments[e];e++)for(var r in t)n[r]=t[r];var a=n.args;n.firstArg=/^[^,]+/.exec(a)[0];var o=Se("hasOwnProperty, isArguments, isArray, isString, keys, lodash, objectTypes","return function("+a+") {\n"+gr(n)+"\n}");return o(Ke,Q,_r,pn,Ar,i,z)}function D(t){return"\\"+I[t]}function F(t){return Mr[t]}function X(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function N(t){this.__wrapped__=t}function W(){}function U(t){var n=!1;if(!t||er.call(t)!=j||!vr.argsClass&&Q(t))return n;var e=t.constructor;return(sn(e)?e instanceof e:vr.nodeClass||!X(t))?vr.ownLast?(Pr(t,function(t,e,r){return n=Ke.call(r,e),!1}),n===!0):(Pr(t,function(t,e){n=e}),n===!1||Ke.call(t,n)):n}function V(t,n,r){n||(n=0),r===e&&(r=t?t.length:0);for(var i=-1,a=r-n||0,o=ze(0>a?0:a);a>++i;)o[i]=t[n+i];return o}function $(t){return Br[t]}function Q(t){return er.call(t)==w}function G(t,n,r,a,o,u){var s=t;if("function"==typeof n&&(a=r,r=n,n=!1),"function"==typeof r){if(r=a===e?r:i.createCallback(r,a,1),s=r(s),s!==e)return s;s=t}var c=cn(s);if(c){var l=er.call(s);if(!O[l]||!vr.nodeClass&&X(s))return s;var f=_r(s)}if(!c||!n)return c?f?V(s):kr({},s):s;var h=pr[l];switch(l){case B:case k:return new h(+s);case P:case C:return new h(s);case T:return h(s.source,p.exec(s))}o||(o=[]),u||(u=[]);for(var d=o.length;d--;)if(o[d]==t)return u[d];return s=f?h(s.length):{},f&&(Ke.call(t,"index")&&(s.index=t.index),Ke.call(t,"input")&&(s.input=t.input)),o.push(t),u.push(s),(f?qn:jr)(t,function(t,i){s[i]=G(t,n,r,e,o,u)}),s}function Y(t,n,e){return G(t,!0,n,e)}function Z(t,n,r){var a;return n=i.createCallback(n,r),jr(t,function(t,r,i){return n(t,r,i)?(a=r,!1):e}),a}function K(t){var n=[];return Pr(t,function(t,e){sn(t)&&n.push(e)}),n.sort()}function J(t,n){return t?Ke.call(t,n):!1}function tn(t){for(var n=-1,e=Ar(t),r=e.length,i={};r>++n;){var a=e[n];i[t[a]]=a}return i}function nn(t){return t===!0||t===!1||er.call(t)==B}function en(t){return t instanceof Le||er.call(t)==k}function rn(t){return t?1===t.nodeType:!1}function an(t){var n=!0;if(!t)return n;var e=er.call(t),r=t.length;return e==M||e==C||(vr.argsClass?e==w:Q(t))||e==j&&"number"==typeof r&&sn(t.splice)?!r:(jr(t,function(){return n=!1}),n)}function on(t,n,r,a,o,u){var c=r===s;if(r&&!c){r=a===e?r:i.createCallback(r,a,2);var l=r(t,n);if(l!==e)return!!l}if(t===n)return 0!==t||1/t==1/n;var f=typeof t,h=typeof n;if(t===t&&(!t||"function"!=f&&"object"!=f)&&(!n||"function"!=h&&"object"!=h))return!1;if(null==t||null==n)return t===n;var d=er.call(t),p=er.call(n);if(d==w&&(d=j),p==w&&(p=j),d!=p)return!1;switch(d){case B:case k:return+t==+n;case P:return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case T:case C:return t==Fe(n)}var v=d==M;if(!v){if(Ke.call(t,"__wrapped__ ")||Ke.call(n,"__wrapped__"))return on(t.__wrapped__||t,n.__wrapped__||n,r,a,o,u);if(d!=j||!vr.nodeClass&&(X(t)||X(n)))return!1;var g=!vr.argsObject&&Q(t)?He:t.constructor,m=!vr.argsObject&&Q(n)?He:n.constructor;if(g!=m&&!(sn(g)&&g instanceof g&&sn(m)&&m instanceof m))return!1}o||(o=[]),u||(u=[]);for(var y=o.length;y--;)if(o[y]==t)return u[y]==n;var x=0;if(l=!0,o.push(t),u.push(n),v){if(y=t.length,x=n.length,l=x==t.length,!l&&!c)return l;for(;x--;){var _=y,b=n[x];if(c)for(;_--&&!(l=on(t[_],b,r,a,o,u)););else if(!(l=on(t[x],b,r,a,o,u)))break}return l}return Pr(n,function(n,i,s){return Ke.call(s,i)?(x++,l=Ke.call(t,i)&&on(t[i],n,r,a,o,u)):e}),l&&!c&&Pr(t,function(t,n,r){return Ke.call(r,n)?l=--x>-1:e}),l}function un(t){return ar(t)&&!or(parseFloat(t))}function sn(t){return"function"==typeof t}function cn(t){return t?z[typeof t]:!1}function ln(t){return hn(t)&&t!=+t}function fn(t){return null===t}function hn(t){return"number"==typeof t||er.call(t)==P}function dn(t){return t instanceof De||er.call(t)==T}function pn(t){return"string"==typeof t||er.call(t)==C}function vn(t){return t===e}function gn(t,n,r){var a=arguments,o=0,u=2;if(!cn(t))return t;if(r===s)var c=a[3],l=a[4],f=a[5];else l=[],f=[],"number"!=typeof r&&(u=a.length),u>3&&"function"==typeof a[u-2]?c=i.createCallback(a[--u-1],a[u--],2):u>2&&"function"==typeof a[u-1]&&(c=a[--u]);for(;u>++o;)(_r(a[o])?qn:jr)(a[o],function(n,r){var i,a,o=n,u=t[r];if(n&&((a=_r(n))||Tr(n))){for(var h=l.length;h--;)if(i=l[h]==n){u=f[h];break}i||(u=a?_r(u)?u:[]:Tr(u)?u:{},c&&(o=c(u,n),o!==e&&(u=o)),l.push(n),f.push(u),c||(u=gn(u,n,s,c,l,f)))}else c&&(o=c(u,n),o===e&&(o=n)),o!==e&&(u=o);t[r]=u});return t}function mn(t,n,e){var r="function"==typeof n,a={};if(r)n=i.createCallback(n,e);else var o=Ge.apply(Ne,arguments);return Pr(t,function(t,e,i){(r?!n(t,e,i):0>Vn(o,e,1))&&(a[e]=t)}),a}function yn(t){for(var n=-1,e=Ar(t),r=e.length,i=ze(r);r>++n;){var a=e[n];i[n]=[a,t[a]]}return i}function xn(t,n,e){var r={};if("function"!=typeof n)for(var a=0,o=Ge.apply(Ne,arguments),u=cn(t)?o.length:0;u>++a;){var s=o[a];s in t&&(r[s]=t[s])}else n=i.createCallback(n,e),Pr(t,function(t,e,i){n(t,e,i)&&(r[e]=t)});return r}function _n(t){for(var n=-1,e=Ar(t),r=e.length,i=ze(r);r>++n;)i[n]=t[e[n]];return i}function bn(t){var n=-1,e=Ge.apply(Ne,V(arguments,1)),r=e.length,i=ze(r);for(vr.unindexedChars&&pn(t)&&(t=t.split(""));r>++n;)i[n]=t[e[n]];return i}function An(t,n,r){var i=-1,a=t?t.length:0,o=!1;return r=(0>r?sr(0,a+r):r)||0,"number"==typeof a?o=(pn(t)?t.indexOf(n,r):Vn(t,n,r))>-1:wr(t,function(t){return++i>=r?!(o=t===n):e}),o}function wn(t,n,e){var r={};return n=i.createCallback(n,e),qn(t,function(t,e,i){e=Fe(n(t,e,i)),Ke.call(r,e)?r[e]++:r[e]=1}),r}function Mn(t,n,e){var r=!0;if(n=i.createCallback(n,e),_r(t))for(var a=-1,o=t.length;o>++a&&(r=!!n(t[a],a,t)););else wr(t,function(t,e,i){return r=!!n(t,e,i)});return r}function Bn(t,n,e){var r=[];if(n=i.createCallback(n,e),_r(t))for(var a=-1,o=t.length;o>++a;){var u=t[a];n(u,a,t)&&r.push(u)}else wr(t,function(t,e,i){n(t,e,i)&&r.push(t)});return r}function kn(t,n,r){if(n=i.createCallback(n,r),!_r(t)){var a;return wr(t,function(t,r,i){return n(t,r,i)?(a=t,!1):e}),a}for(var o=-1,u=t.length;u>++o;){var s=t[o];if(n(s,o,t))return s}}function qn(t,n,r){if(n&&r===e&&_r(t))for(var i=-1,a=t.length;a>++i&&n(t[i],i,t)!==!1;);else wr(t,n,r);return t}function Pn(t,n,e){var r={};return n=i.createCallback(n,e),qn(t,function(t,e,i){e=Fe(n(t,e,i)),(Ke.call(r,e)?r[e]:r[e]=[]).push(t)}),r}function jn(t,n){var e=V(arguments,2),r=-1,i="function"==typeof n,a=t?t.length:0,o=ze("number"==typeof a?a:0);return qn(t,function(t){o[++r]=(i?n:t[n]).apply(t,e)}),o}function Tn(t,n,e){var r=-1,a=t?t.length:0,o=ze("number"==typeof a?a:0);if(n=i.createCallback(n,e),_r(t))for(;a>++r;)o[r]=n(t[r],r,t);else wr(t,function(t,e,i){o[++r]=n(t,e,i)});return o}function Cn(t,n,e){var r=-1/0,a=r;if(!n&&_r(t))for(var o=-1,u=t.length;u>++o;){var s=t[o];s>a&&(a=s)}else n=!n&&pn(t)?S:i.createCallback(n,e),wr(t,function(t,e,i){var o=n(t,e,i);o>r&&(r=o,a=t)});return a}function On(t,n,e){var r=1/0,a=r;if(!n&&_r(t))for(var o=-1,u=t.length;u>++o;){var s=t[o];a>s&&(a=s)}else n=!n&&pn(t)?S:i.createCallback(n,e),wr(t,function(t,e,i){var o=n(t,e,i);r>o&&(r=o,a=t)});return a}function zn(t,n,e,r){var a=3>arguments.length;if(n=i.createCallback(n,r,4),_r(t)){var o=-1,u=t.length;for(a&&(e=t[++o]);u>++o;)e=n(e,t[o],o,t)}else wr(t,function(t,r,i){e=a?(a=!1,t):n(e,t,r,i)});return e}function In(t,n,e,r){var a=t,o=t?t.length:0,u=3>arguments.length;if("number"!=typeof o){var s=Ar(t);o=s.length}else vr.unindexedChars&&pn(t)&&(a=t.split(""));return n=i.createCallback(n,r,4),qn(t,function(t,r,i){r=s?s[--o]:--o,e=u?(u=!1,a[r]):n(e,a[r],r,i)}),e}function Ln(t,n,e){return n=i.createCallback(n,e),Bn(t,function(t,e,r){return!n(t,e,r)})}function Sn(t){var n=-1,e=t?t.length:0,r=ze("number"==typeof e?e:0);return qn(t,function(t){var e=Ye(fr()*(++n+1));r[n]=r[e],r[e]=t}),r}function En(t){var n=t?t.length:0;return"number"==typeof n?n:Ar(t).length}function Rn(t,n,e){var r;if(n=i.createCallback(n,e),_r(t))for(var a=-1,o=t.length;o>++a&&!(r=n(t[a],a,t)););else wr(t,function(t,e,i){return!(r=n(t,e,i))});return!!r}function Hn(t,n,e){var r=-1,a=t?t.length:0,o=ze("number"==typeof a?a:0);for(n=i.createCallback(n,e),qn(t,function(t,e,i){o[++r]={criteria:n(t,e,i),index:r,value:t}}),a=o.length,o.sort(E);a--;)o[a]=o[a].value;return o}function Dn(t){return t&&"number"==typeof t.length?vr.unindexedChars&&pn(t)?t.split(""):V(t):_n(t)}function Fn(t){for(var n=-1,e=t?t.length:0,r=[];e>++n;){var i=t[n];i&&r.push(i)}return r}function Xn(t){for(var n=-1,e=t?t.length:0,r=Ge.apply(Ne,arguments),i=o(r,e,100),a=[];e>++n;){var u=t[n];i(u)||a.push(u)}return a}function Nn(t,n,e){var r=-1,a=t?t.length:0;for(n=i.createCallback(n,e);a>++r;)if(n(t[r],r,t))return r;return-1}function Wn(t,n,e){if(t){var r=0,a=t.length;if("number"!=typeof n&&null!=n){var o=-1;for(n=i.createCallback(n,e);a>++o&&n(t[o],o,t);)r++}else if(r=n,null==r||e)return t[0];return V(t,0,cr(sr(0,r),a))}}function Un(t,n,e,r){var a=-1,o=t?t.length:0,u=[];for("boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1),null!=e&&(e=i.createCallback(e,r));o>++a;){var s=t[a];e&&(s=e(s,a,t)),_r(s)?Je.apply(u,n?s:Un(s)):u.push(s)}return u}function Vn(t,n,e){var r=-1,i=t?t.length:0;if("number"==typeof e)r=(0>e?sr(0,i+e):e||0)-1;else if(e)return r=Jn(t,n),t[r]===n?r:-1;for(;i>++r;)if(t[r]===n)return r;return-1}function $n(t,n,e){if(!t)return[];var r=0,a=t.length;if("number"!=typeof n&&null!=n){var o=a;for(n=i.createCallback(n,e);o--&&n(t[o],o,t);)r++}else r=null==n||e?1:n||r;return V(t,0,cr(sr(0,a-r),a))}function Qn(t){var n=arguments,e=n.length,r={0:{}},i=-1,a=t?t.length:0,u=a>=100,s=[],c=s;t:for(;a>++i;){var l=t[i];if(u)var f=Fe(l),h=Ke.call(r[0],f)?!(c=r[0][f]):c=r[0][f]=[];if(h||0>Vn(c,l)){u&&c.push(l);for(var d=e;--d;)if(!(r[d]||(r[d]=o(n[d],0,100)))(l))continue t;s.push(l)}}return s}function Gn(t,n,e){if(t){var r=0,a=t.length;if("number"!=typeof n&&null!=n){var o=a;for(n=i.createCallback(n,e);o--&&n(t[o],o,t);)r++}else if(r=n,null==r||e)return t[a-1];return V(t,sr(0,a-r))}}function Yn(t,n,e){var r=t?t.length:0;for("number"==typeof e&&(r=(0>e?sr(0,r+e):cr(e,r-1))+1);r--;)if(t[r]===n)return r;return-1}function Zn(t,n,e){t=+t||0,e=+e||1,null==n&&(n=t,t=0);for(var r=-1,i=sr(0,$e((n-t)/e)),a=ze(i);i>++r;)a[r]=t,t+=e;return a}function Kn(t,n,e){if("number"!=typeof n&&null!=n){var r=0,a=-1,o=t?t.length:0;for(n=i.createCallback(n,e);o>++a&&n(t[a],a,t);)r++}else r=null==n||e?1:sr(0,n);return V(t,r)}function Jn(t,n,e,r){var a=0,o=t?t.length:a;for(e=e?i.createCallback(e,r,1):be,n=e(n);o>a;){var u=a+o>>>1;n>e(t[u])?a=u+1:o=u}return a}function te(){return ne(Ge.apply(Ne,arguments))}function ne(t,n,e,r){var a=-1,o=t?t.length:0,u=[],s=u;"boolean"!=typeof n&&null!=n&&(r=e,e=n,n=!1);var c=!n&&o>=75;if(c)var l={};for(null!=e&&(s=[],e=i.createCallback(e,r));o>++a;){var f=t[a],h=e?e(f,a,t):f;if(c)var d=Fe(h),p=Ke.call(l,d)?!(s=l[d]):s=l[d]=[];(n?!a||s[s.length-1]!==h:p||0>Vn(s,h))&&((e||c)&&s.push(h),u.push(f))}return u}function ee(t){for(var n=-1,e=t?t.length:0,r=o(arguments,1,30),i=[];e>++n;){var a=t[n];r(a)||i.push(a)}return i}function re(t){for(var n=-1,e=t?Cn(Cr(arguments,"length")):0,r=ze(e);e>++n;)r[n]=Cr(arguments,n);return r}function ie(t,n){for(var e=-1,r=t?t.length:0,i={};r>++e;){var a=t[e];n?i[a]=n[e]:i[a[0]]=a[1]}return i}function ae(t,n){return 1>t?n():function(){return 1>--t?n.apply(this,arguments):e}}function oe(t,n){return vr.fastBind||rr&&arguments.length>2?rr.call.apply(rr,arguments):R(t,n,V(arguments,2))}function ue(t){for(var n=Ge.apply(Ne,arguments),e=n.length>1?0:(n=K(t),-1),r=n.length;r>++e;){var i=n[e];t[i]=oe(t[i],t)}return t}function se(t,n){return R(t,n,V(arguments,2),s)}function ce(){var t=arguments;return function(){for(var n=arguments,e=t.length;e--;)n=[t[e].apply(this,n)];return n[0]}}function le(t,n,r){if(null==t)return be;var i=typeof t;if("function"!=i){if("object"!=i)return function(n){return n[t]};var a=Ar(t);return function(n){for(var e=a.length,r=!1;e--&&(r=on(n[a[e]],t[a[e]],s)););return r}}return n!==e?1===r?function(e){return t.call(n,e)}:2===r?function(e,r){return t.call(n,e,r)}:4===r?function(e,r,i,a){return t.call(n,e,r,i,a)}:function(e,r,i){return t.call(n,e,r,i)}:t}function fe(t,n,e){function r(){u=null,e||(a=t.apply(o,i))}var i,a,o,u;return function(){var s=e&&!u;return i=arguments,o=this,Qe(u),u=nr(r,n),s&&(a=t.apply(o,i)),a}}function he(t){var n=V(arguments,1);return nr(function(){t.apply(e,n)},1)}function de(t,n){var r=V(arguments,2);return nr(function(){t.apply(e,r)},n)}function pe(t,n){var e={};return function(){var r=Fe(n?n.apply(this,arguments):arguments[0]);return Ke.call(e,r)?e[r]:e[r]=t.apply(this,arguments)}}function ve(t){var n,e;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}function ge(t){return R(t,V(arguments,1))}function me(t){return R(t,V(arguments,1),null,s)}function ye(t,n){function e(){u=new Le,o=null,i=t.apply(a,r)}var r,i,a,o,u=0;return function(){var s=new Le,c=n-(s-u);return r=arguments,a=this,0>=c?(Qe(o),o=null,u=s,i=t.apply(a,r)):o||(o=nr(e,c)),i}}function xe(t,n){return function(){var e=[t];return Je.apply(e,arguments),n.apply(this,e)}}function _e(t){return null==t?"":Fe(t).replace(y,F)}function be(t){return t}function Ae(t){qn(K(t),function(n){var e=i[n]=t[n];i.prototype[n]=function(){var t=this.__wrapped__,n=[t];Je.apply(n,arguments);var r=e.apply(i,n);return t&&"object"==typeof t&&t==r?this:new N(r)}})}function we(){return r._=Ue,this}function Me(t,n){return null==t&&null==n&&(n=1),t=+t||0,null==n&&(n=t,t=0),t+Ye(fr()*((+n||0)-t+1))}function Be(t,n){var r=t?t[n]:e;return sn(r)?t[n]():r}function ke(t,n,r){var a=i.templateSettings;t||(t=""),r=qr({},r,a);var o,u=qr({},r.imports,a.imports),s=Ar(u),h=_n(u),p=0,g=r.interpolate||m,y="__p += '",_=De((r.escape||m).source+"|"+g.source+"|"+(g===v?d:m).source+"|"+(r.evaluate||m).source+"|$","g");t.replace(_,function(n,e,r,i,a,u){return r||(r=i),y+=t.slice(p,u).replace(x,D),e&&(y+="' +\n__e("+e+") +\n'"),a&&(o=!0,y+="';\n"+a+";\n__p += '"),r&&(y+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),p=u+n.length,n}),y+="';\n";var b=r.variable,w=b;w||(b="obj",y="with ("+b+") {\n"+y+"\n}\n"),y=(o?y.replace(c,""):y).replace(l,"$1").replace(f,"$1;"),y="function("+b+") {\n"+(w?"":b+" || ("+b+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+y+"return __p\n}";var M="\n/*\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+A++ +"]")+"\n*/";try{var B=Se(s,"return "+y+M).apply(e,h)}catch(k){throw k.source=y,k}return n?B(n):(B.source=y,B)}function qe(t,n,e){t=(t=+t)>-1?t:0;var r=-1,a=ze(t);for(n=i.createCallback(n,e,1);t>++r;)a[r]=n(r);return a}function Pe(t){return null==t?"":Fe(t).replace(h,$)}function je(t){var n=++u;return Fe(null==t?"":t)+n}function Te(t,n){return n(t),t}function Ce(){return Fe(this.__wrapped__)}function Oe(){return this.__wrapped__}r=r?L.defaults(t.Object(),r,L.pick(t,_)):t;var ze=r.Array,Ie=r.Boolean,Le=r.Date,Se=r.Function,Ee=r.Math,Re=r.Number,He=r.Object,De=r.RegExp,Fe=r.String,Xe=r.TypeError,Ne=ze(),We=He(),Ue=r._,Ve=De("^"+Fe(We.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),$e=Ee.ceil,Qe=r.clearTimeout,Ge=Ne.concat,Ye=Ee.floor,Ze=Ve.test(Ze=He.getPrototypeOf)&&Ze,Ke=We.hasOwnProperty,Je=Ne.push,tr=r.setImmediate,nr=r.setTimeout,er=We.toString,rr=Ve.test(rr=V.bind)&&rr,ir=Ve.test(ir=ze.isArray)&&ir,ar=r.isFinite,or=r.isNaN,ur=Ve.test(ur=He.keys)&&ur,sr=Ee.max,cr=Ee.min,lr=r.parseInt,fr=Ee.random,hr=Ve.test(r.attachEvent),dr=rr&&!/\n|true/.test(rr+hr),pr={};pr[M]=ze,pr[B]=Ie,pr[k]=Le,pr[j]=He,pr[P]=Re,pr[T]=De,pr[C]=Fe;var vr=i.support={};(function(){var t=function(){this.x=1},n={0:1,length:1},e=[];t.prototype={valueOf:1,y:1};for(var r in new t)e.push(r);for(r in arguments);vr.argsObject=arguments.constructor==He,vr.argsClass=Q(arguments),vr.enumPrototypes=t.propertyIsEnumerable("prototype"),vr.fastBind=rr&&!dr,vr.ownLast="x"!=e[0],vr.nonEnumArgs=0!=r,vr.nonEnumShadows=!/valueOf/.test(e),vr.spliceObjects=(Ne.splice.call(n,0,1),!n[0]),vr.unindexedChars="xx"!="x"[0]+He("x")[0];try{vr.nodeClass=!(er.call(document)==j&&!({toString:0}+""))}catch(i){vr.nodeClass=!0}})(1),i.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:v,variable:"",imports:{_:i}};var gr=function(t){var n="var index, iterable = "+t.firstArg+", result = "+t.init+";\nif (!iterable) return result;\n"+t.top+";\n";if(t.arrays?(n+="var length = iterable.length; index = -1;\nif ("+t.arrays+") {  ",vr.unindexedChars&&(n+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),n+="\n  while (++index < length) {\n    "+t.loop+"\n  }\n}\nelse {  "):vr.nonEnumArgs&&(n+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+t.loop+"\n    }\n  } else {  "),vr.enumPrototypes&&(n+="\n  var skipProto = typeof iterable == 'function';\n  "),t.useHas&&t.useKeys)n+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] ? keys(iterable) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    ",vr.enumPrototypes&&(n+="if (!(skipProto && index == 'prototype')) {\n  "),n+=t.loop,vr.enumPrototypes&&(n+="}\n"),n+="  }  ";else if(n+="\n  for (index in iterable) {",(vr.enumPrototypes||t.useHas)&&(n+="\n    if (",vr.enumPrototypes&&(n+="!(skipProto && index == 'prototype')"),vr.enumPrototypes&&t.useHas&&(n+=" && "),t.useHas&&(n+="hasOwnProperty.call(iterable, index)"),n+=") {    "),n+=t.loop+";    ",(vr.enumPrototypes||t.useHas)&&(n+="\n    }"),n+="\n  }    ",vr.nonEnumShadows){n+="\n\n  var ctor = iterable.constructor;\n      ";for(var e=0;7>e;e++)n+="\n  index = '"+t.shadowedProps[e]+"';\n  if (","constructor"==t.shadowedProps[e]&&(n+="!(ctor && ctor.prototype === iterable) && "),n+="hasOwnProperty.call(iterable, index)) {\n    "+t.loop+"\n  }      "}return(t.arrays||vr.nonEnumArgs)&&(n+="\n}"),n+=t.bottom+";\nreturn result"},mr={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},yr={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : lodash.createCallback(callback, thisArg)",arrays:"typeof length == 'number'",loop:"if (callback(iterable[index], index, collection) === false) return result"},xr={top:"if (!objectTypes[typeof iterable]) return result;\n"+yr.top,arrays:!1};N.prototype=i.prototype,vr.argsClass||(Q=function(t){return t?Ke.call(t,"callee"):!1});var _r=ir||function(t){return vr.argsObject&&t instanceof ze||er.call(t)==M},br=H({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)",arrays:!1}),Ar=ur?function(t){return cn(t)?vr.enumPrototypes&&"function"==typeof t||vr.nonEnumArgs&&t.length&&Q(t)?br(t):ur(t):[]}:br,wr=H(yr),Mr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Br=tn(Mr),kr=H(mr,{top:mr.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = lodash.createCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),qr=H(mr),Pr=H(yr,xr,{useHas:!1}),jr=H(yr,xr);sn(/x/)&&(sn=function(t){return t instanceof Se||er.call(t)==q});var Tr=Ze?function(t){if(!t||er.call(t)!=j||!vr.argsClass&&Q(t))return!1;var n=t.valueOf,e="function"==typeof n&&(e=Ze(n))&&Ze(e);return e?t==e||Ze(t)==e:U(t)}:U,Cr=Tn,Or=Bn;dr&&a&&"function"==typeof tr&&(he=oe(tr,r));var zr=8==lr("08")?lr:function(t,n){return lr(pn(t)?t.replace(g,""):t,n||0)};return i.after=ae,i.assign=kr,i.at=bn,i.bind=oe,i.bindAll=ue,i.bindKey=se,i.compact=Fn,i.compose=ce,i.countBy=wn,i.createCallback=le,i.debounce=fe,i.defaults=qr,i.defer=he,i.delay=de,i.difference=Xn,i.filter=Bn,i.flatten=Un,i.forEach=qn,i.forIn=Pr,i.forOwn=jr,i.functions=K,i.groupBy=Pn,i.initial=$n,i.intersection=Qn,i.invert=tn,i.invoke=jn,i.keys=Ar,i.map=Tn,i.max=Cn,i.memoize=pe,i.merge=gn,i.min=On,i.omit=mn,i.once=ve,i.pairs=yn,i.partial=ge,i.partialRight=me,i.pick=xn,i.pluck=Cr,i.range=Zn,i.reject=Ln,i.rest=Kn,i.shuffle=Sn,i.sortBy=Hn,i.tap=Te,i.throttle=ye,i.times=qe,i.toArray=Dn,i.union=te,i.uniq=ne,i.values=_n,i.where=Or,i.without=ee,i.wrap=xe,i.zip=re,i.zipObject=ie,i.collect=Tn,i.drop=Kn,i.each=qn,i.extend=kr,i.methods=K,i.object=ie,i.select=Bn,i.tail=Kn,i.unique=ne,Ae(i),i.clone=G,i.cloneDeep=Y,i.contains=An,i.escape=_e,i.every=Mn,i.find=kn,i.findIndex=Nn,i.findKey=Z,i.has=J,i.identity=be,i.indexOf=Vn,i.isArguments=Q,i.isArray=_r,i.isBoolean=nn,i.isDate=en,i.isElement=rn,i.isEmpty=an,i.isEqual=on,i.isFinite=un,i.isFunction=sn,i.isNaN=ln,i.isNull=fn,i.isNumber=hn,i.isObject=cn,i.isPlainObject=Tr,i.isRegExp=dn,i.isString=pn,i.isUndefined=vn,i.lastIndexOf=Yn,i.mixin=Ae,i.noConflict=we,i.parseInt=zr,i.random=Me,i.reduce=zn,i.reduceRight=In,i.result=Be,i.runInContext=n,i.size=En,i.some=Rn,i.sortedIndex=Jn,i.template=ke,i.unescape=Pe,i.uniqueId=je,i.all=Mn,i.any=Rn,i.detect=kn,i.foldl=zn,i.foldr=In,i.include=An,i.inject=zn,jr(i,function(t,n){i.prototype[n]||(i.prototype[n]=function(){var n=[this.__wrapped__];return Je.apply(n,arguments),t.apply(i,n)})}),i.first=Wn,i.last=Gn,i.take=Wn,i.head=Wn,jr(i,function(t,n){i.prototype[n]||(i.prototype[n]=function(n,e){var r=t(this.__wrapped__,n,e);return null==n||e&&"function"!=typeof n?r:new N(r)})}),i.VERSION="1.1.1",i.prototype.toString=Ce,i.prototype.value=Oe,i.prototype.valueOf=Oe,wr(["join","pop","shift"],function(t){var n=Ne[t];i.prototype[t]=function(){return n.apply(this.__wrapped__,arguments)}}),wr(["push","reverse","sort","unshift"],function(t){var n=Ne[t];i.prototype[t]=function(){return n.apply(this.__wrapped__,arguments),this}}),wr(["concat","slice","splice"],function(t){var n=Ne[t];i.prototype[t]=function(){return new N(n.apply(this.__wrapped__,arguments))}}),vr.spliceObjects||wr(["pop","shift","splice"],function(t){var n=Ne[t],e="splice"==t;i.prototype[t]=function(){var t=this.__wrapped__,r=n.apply(t,arguments);return 0===t.length&&delete t[0],e?new N(r):r}}),i}var e,i="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==i&&module,o="object"==typeof global&&global;o.global===o&&(t=o);var u=0,s={},c=/\b__p \+= '';/g,l=/\b(__p \+=) '' \+/g,f=/(__e\(.*?\)|\b__t\)) \+\n'';/g,h=/&(?:amp|lt|gt|quot|#39);/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,p=/\w*$/,v=/<%=([\s\S]+?)%>/g,g=/^0+(?=.$)/,m=/($^)/,y=/[&<>"']/g,x=/['\n\r\t\u2028\u2029\\]/g,_=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],b=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],A=0,w="[object Arguments]",M="[object Array]",B="[object Boolean]",k="[object Date]",q="[object Function]",P="[object Number]",j="[object Object]",T="[object RegExp]",C="[object String]",O={};O[q]=!1,O[w]=O[M]=O[B]=O[k]=O[P]=O[j]=O[T]=O[C]=!0;var z={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},I={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},L=n();"function"==typeof r&&"object"==typeof r.amd&&r.amd?(t._=L,r("_",[],function(){return L})):i&&!i.nodeType?a?(a.exports=L)._=L:i._=L:t._=L}(this),r("core/base",["require","./mixin/derive","./mixin/notifier","./mixin/dirty","./cache","_"],function(t){var n=t("./mixin/derive"),e=t("./mixin/notifier"),r=t("./mixin/dirty"),i=t("./cache"),a=t("_"),o=function(){this.cache=new i};return a.extend(o,n),a.extend(o.prototype,e),a.extend(o.prototype,r),o}),function(t){var n={};"undefined"==typeof exports?"function"==typeof r&&"object"==typeof r.amd&&r.amd?(n.exports={},r("glmatrix",[],function(){return n.exports})):n.exports="undefined"!=typeof window?window:t:n.exports=exports,function(t){if(!n)var n=1e-6;if(!e)var e="undefined"!=typeof Float32Array?Float32Array:Array;if(!r)var r=Math.random;var i={};i.setMatrixArrayType=function(t){e=t},t!==void 0&&(t.glMatrix=i);var a={};a.create=function(){var t=new e(2);return t[0]=0,t[1]=0,t},a.clone=function(t){var n=new e(2);return n[0]=t[0],n[1]=t[1],n},a.fromValues=function(t,n){var r=new e(2);return r[0]=t,r[1]=n,r},a.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},a.set=function(t,n,e){return t[0]=n,t[1]=e,t},a.add=function(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t},a.subtract=function(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t},a.sub=a.subtract,a.multiply=function(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t},a.mul=a.multiply,a.divide=function(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t},a.div=a.divide,a.min=function(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t},a.max=function(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t},a.scale=function(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t},a.scaleAndAdd=function(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t},a.distance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(e*e+r*r)},a.dist=a.distance,a.squaredDistance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1];return e*e+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var n=t[0],e=t[1];return Math.sqrt(n*n+e*e)},a.len=a.length,a.squaredLength=function(t){var n=t[0],e=t[1];return n*n+e*e},a.sqrLen=a.squaredLength,a.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},a.normalize=function(t,n){var e=n[0],r=n[1],i=e*e+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t},a.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},a.cross=function(t,n,e){var r=n[0]*e[1]-n[1]*e[0];return t[0]=t[1]=0,t[2]=r,t},a.lerp=function(t,n,e,r){var i=n[0],a=n[1];return t[0]=i+r*(e[0]-i),t[1]=a+r*(e[1]-a),t},a.random=function(t,n){n=n||1;var e=2*r()*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t},a.transformMat2=function(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i,t[1]=e[1]*r+e[3]*i,t},a.transformMat2d=function(t,n,e){var r=n[0],i=n[1];
return t[0]=e[0]*r+e[2]*i+e[4],t[1]=e[1]*r+e[3]*i+e[5],t},a.transformMat3=function(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[3]*i+e[6],t[1]=e[1]*r+e[4]*i+e[7],t},a.transformMat4=function(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[4]*i+e[12],t[1]=e[1]*r+e[5]*i+e[13],t},a.forEach=function(){var t=a.create();return function(n,e,r,i,a,o){var u,s;for(e||(e=2),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;s>u;u+=e)t[0]=n[u],t[1]=n[u+1],a(t,t,o),n[u]=t[0],n[u+1]=t[1];return n}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t!==void 0&&(t.vec2=a);var o={};o.create=function(){var t=new e(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var n=new e(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},o.fromValues=function(t,n,r){var i=new e(3);return i[0]=t,i[1]=n,i[2]=r,i},o.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},o.set=function(t,n,e,r){return t[0]=n,t[1]=e,t[2]=r,t},o.add=function(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t},o.subtract=function(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t},o.sub=o.subtract,o.multiply=function(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t},o.mul=o.multiply,o.divide=function(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t},o.div=o.divide,o.min=function(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t},o.max=function(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t},o.scale=function(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t},o.scaleAndAdd=function(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t},o.distance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(e*e+r*r+i*i)},o.dist=o.distance,o.squaredDistance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return e*e+r*r+i*i},o.sqrDist=o.squaredDistance,o.length=function(t){var n=t[0],e=t[1],r=t[2];return Math.sqrt(n*n+e*e+r*r)},o.len=o.length,o.squaredLength=function(t){var n=t[0],e=t[1],r=t[2];return n*n+e*e+r*r},o.sqrLen=o.squaredLength,o.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},o.normalize=function(t,n){var e=n[0],r=n[1],i=n[2],a=e*e+r*r+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a),t},o.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]},o.cross=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=e[0],u=e[1],s=e[2];return t[0]=i*s-a*u,t[1]=a*o-r*s,t[2]=r*u-i*o,t},o.lerp=function(t,n,e,r){var i=n[0],a=n[1],o=n[2];return t[0]=i+r*(e[0]-i),t[1]=a+r*(e[1]-a),t[2]=o+r*(e[2]-o),t},o.random=function(t,n){n=n||1;var e=2*r()*Math.PI,i=2*r()-1,a=Math.sqrt(1-i*i)*n;return t[0]=Math.cos(e)*a,t[1]=Math.sin(e)*a,t[2]=i*n,t},o.transformMat4=function(t,n,e){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r+e[4]*i+e[8]*a+e[12],t[1]=e[1]*r+e[5]*i+e[9]*a+e[13],t[2]=e[2]*r+e[6]*i+e[10]*a+e[14],t},o.transformMat3=function(t,n,e){var r=n[0],i=n[1],a=n[2];return t[0]=r*e[0]+i*e[3]+a*e[6],t[1]=r*e[1]+i*e[4]+a*e[7],t[2]=r*e[2]+i*e[5]+a*e[8],t},o.transformQuat=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=e[0],u=e[1],s=e[2],c=e[3],l=c*r+u*a-s*i,f=c*i+s*r-o*a,h=c*a+o*i-u*r,d=-o*r-u*i-s*a;return t[0]=l*c+d*-o+f*-s-h*-u,t[1]=f*c+d*-u+h*-o-l*-s,t[2]=h*c+d*-s+l*-u-f*-o,t},o.forEach=function(){var t=o.create();return function(n,e,r,i,a,o){var u,s;for(e||(e=3),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;s>u;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],a(t,t,o),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2];return n}}(),o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t!==void 0&&(t.vec3=o);var u={};u.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var n=new e(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},u.fromValues=function(t,n,r,i){var a=new e(4);return a[0]=t,a[1]=n,a[2]=r,a[3]=i,a},u.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},u.set=function(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t},u.add=function(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t},u.subtract=function(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t},u.sub=u.subtract,u.multiply=function(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t[3]=n[3]*e[3],t},u.mul=u.multiply,u.divide=function(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t[3]=n[3]/e[3],t},u.div=u.divide,u.min=function(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t[3]=Math.min(n[3],e[3]),t},u.max=function(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t[3]=Math.max(n[3],e[3]),t},u.scale=function(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t},u.scaleAndAdd=function(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t},u.distance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],a=n[3]-t[3];return Math.sqrt(e*e+r*r+i*i+a*a)},u.dist=u.distance,u.squaredDistance=function(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],a=n[3]-t[3];return e*e+r*r+i*i+a*a},u.sqrDist=u.squaredDistance,u.length=function(t){var n=t[0],e=t[1],r=t[2],i=t[3];return Math.sqrt(n*n+e*e+r*r+i*i)},u.len=u.length,u.squaredLength=function(t){var n=t[0],e=t[1],r=t[2],i=t[3];return n*n+e*e+r*r+i*i},u.sqrLen=u.squaredLength,u.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t},u.normalize=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=e*e+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o,t[3]=n[3]*o),t},u.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]},u.lerp=function(t,n,e,r){var i=n[0],a=n[1],o=n[2],u=n[3];return t[0]=i+r*(e[0]-i),t[1]=a+r*(e[1]-a),t[2]=o+r*(e[2]-o),t[3]=u+r*(e[3]-u),t},u.random=function(t,n){return n=n||1,t[0]=r(),t[1]=r(),t[2]=r(),t[3]=r(),u.normalize(t,t),u.scale(t,t,n),t},u.transformMat4=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3];return t[0]=e[0]*r+e[4]*i+e[8]*a+e[12]*o,t[1]=e[1]*r+e[5]*i+e[9]*a+e[13]*o,t[2]=e[2]*r+e[6]*i+e[10]*a+e[14]*o,t[3]=e[3]*r+e[7]*i+e[11]*a+e[15]*o,t},u.transformQuat=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=e[0],u=e[1],s=e[2],c=e[3],l=c*r+u*a-s*i,f=c*i+s*r-o*a,h=c*a+o*i-u*r,d=-o*r-u*i-s*a;return t[0]=l*c+d*-o+f*-s-h*-u,t[1]=f*c+d*-u+h*-o-l*-s,t[2]=h*c+d*-s+l*-u-f*-o,t},u.forEach=function(){var t=u.create();return function(n,e,r,i,a,o){var u,s;for(e||(e=4),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;s>u;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],t[3]=n[u+3],a(t,t,o),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2],n[u+3]=t[3];return n}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.vec4=u);var s={};s.create=function(){var t=new e(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},s.clone=function(t){var n=new e(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},s.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},s.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},s.transpose=function(t,n){if(t===n){var e=n[1];t[1]=n[2],t[2]=e}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},s.invert=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=e*a-i*r;return o?(o=1/o,t[0]=a*o,t[1]=-r*o,t[2]=-i*o,t[3]=e*o,t):null},s.adjoint=function(t,n){var e=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=e,t},s.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},s.multiply=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=r*u+i*c,t[1]=r*s+i*l,t[2]=a*u+o*c,t[3]=a*s+o*l,t},s.mul=s.multiply,s.rotate=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+i*u,t[1]=r*-u+i*s,t[2]=a*s+o*u,t[3]=a*-u+o*s,t},s.scale=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=e[0],s=e[1];return t[0]=r*u,t[1]=i*s,t[2]=a*u,t[3]=o*s,t},s.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.mat2=s);var c={};c.create=function(){var t=new e(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.clone=function(t){var n=new e(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},c.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.invert=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=e*a-r*i;return s?(s=1/s,t[0]=a*s,t[1]=-r*s,t[2]=-i*s,t[3]=e*s,t[4]=(i*u-a*o)*s,t[5]=(r*o-e*u)*s,t):null},c.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},c.multiply=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=e[0],l=e[1],f=e[2],h=e[3],d=e[4],p=e[5];return t[0]=r*c+i*f,t[1]=r*l+i*h,t[2]=a*c+o*f,t[3]=a*l+o*h,t[4]=c*u+f*s+d,t[5]=l*u+h*s+p,t},c.mul=c.multiply,c.rotate=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=Math.sin(e),l=Math.cos(e);return t[0]=r*l+i*c,t[1]=-r*c+i*l,t[2]=a*l+o*c,t[3]=-a*c+l*o,t[4]=l*u+c*s,t[5]=l*s-c*u,t},c.scale=function(t,n,e){var r=e[0],i=e[1];return t[0]=n[0]*r,t[1]=n[1]*i,t[2]=n[2]*r,t[3]=n[3]*i,t[4]=n[4]*r,t[5]=n[5]*i,t},c.translate=function(t,n,e){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4]+e[0],t[5]=n[5]+e[1],t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},t!==void 0&&(t.mat2d=c);var l={};l.create=function(){var t=new e(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.fromMat4=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},l.clone=function(t){var n=new e(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},l.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.transpose=function(t,n){if(t===n){var e=n[1],r=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=e,t[5]=n[7],t[6]=r,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},l.invert=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=l*o-u*c,h=-l*a+u*s,d=c*a-o*s,p=e*f+r*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-l*r+i*c)*p,t[2]=(u*r-i*o)*p,t[3]=h*p,t[4]=(l*e-i*s)*p,t[5]=(-u*e+i*a)*p,t[6]=d*p,t[7]=(-c*e+r*s)*p,t[8]=(o*e-r*a)*p,t):null},l.adjoint=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=n[6],c=n[7],l=n[8];return t[0]=o*l-u*c,t[1]=i*c-r*l,t[2]=r*u-i*o,t[3]=u*s-a*l,t[4]=e*l-i*s,t[5]=i*a-e*u,t[6]=a*c-o*s,t[7]=r*s-e*c,t[8]=e*o-r*a,t},l.determinant=function(t){var n=t[0],e=t[1],r=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],c=t[8];return n*(c*a-o*s)+e*(-c*i+o*u)+r*(s*i-a*u)},l.multiply=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=e[0],d=e[1],p=e[2],v=e[3],g=e[4],m=e[5],y=e[6],x=e[7],_=e[8];return t[0]=h*r+d*o+p*c,t[1]=h*i+d*u+p*l,t[2]=h*a+d*s+p*f,t[3]=v*r+g*o+m*c,t[4]=v*i+g*u+m*l,t[5]=v*a+g*s+m*f,t[6]=y*r+x*o+_*c,t[7]=y*i+x*u+_*l,t[8]=y*a+x*s+_*f,t},l.mul=l.multiply,l.translate=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=e[0],d=e[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=u,t[5]=s,t[6]=h*r+d*o+c,t[7]=h*i+d*u+l,t[8]=h*a+d*s+f,t},l.rotate=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=Math.sin(e),d=Math.cos(e);return t[0]=d*r+h*o,t[1]=d*i+h*u,t[2]=d*a+h*s,t[3]=d*o-h*r,t[4]=d*u-h*i,t[5]=d*s-h*a,t[6]=c,t[7]=l,t[8]=f,t},l.scale=function(t,n,e){var r=e[0],i=e[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},l.fromMat2d=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},l.fromQuat=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=e+e,u=r+r,s=i+i,c=e*o,l=e*u,f=e*s,h=r*u,d=r*s,p=i*s,v=a*o,g=a*u,m=a*s;return t[0]=1-(h+p),t[3]=l+m,t[6]=f-g,t[1]=l-m,t[4]=1-(c+p),t[7]=d+v,t[2]=f+g,t[5]=d-v,t[8]=1-(c+h),t},l.normalFromMat4=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],p=n[12],v=n[13],g=n[14],m=n[15],y=e*u-r*o,x=e*s-i*o,_=e*c-a*o,b=r*s-i*u,A=r*c-a*u,w=i*c-a*s,M=l*v-f*p,B=l*g-h*p,k=l*m-d*p,q=f*g-h*v,P=f*m-d*v,j=h*m-d*g,T=y*j-x*P+_*q+b*k-A*B+w*M;return T?(T=1/T,t[0]=(u*j-s*P+c*q)*T,t[1]=(s*k-o*j-c*B)*T,t[2]=(o*P-u*k+c*M)*T,t[3]=(i*P-r*j-a*q)*T,t[4]=(e*j-i*k+a*B)*T,t[5]=(r*k-e*P-a*M)*T,t[6]=(v*w-g*A+m*b)*T,t[7]=(g*_-p*w-m*x)*T,t[8]=(p*A-v*_+m*y)*T,t):null},l.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},t!==void 0&&(t.mat3=l);var f={};f.create=function(){var t=new e(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.clone=function(t){var n=new e(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},f.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.transpose=function(t,n){if(t===n){var e=n[1],r=n[2],i=n[3],a=n[6],o=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=e,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=a,t[11]=n[14],t[12]=i,t[13]=o,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},f.invert=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],p=n[12],v=n[13],g=n[14],m=n[15],y=e*u-r*o,x=e*s-i*o,_=e*c-a*o,b=r*s-i*u,A=r*c-a*u,w=i*c-a*s,M=l*v-f*p,B=l*g-h*p,k=l*m-d*p,q=f*g-h*v,P=f*m-d*v,j=h*m-d*g,T=y*j-x*P+_*q+b*k-A*B+w*M;return T?(T=1/T,t[0]=(u*j-s*P+c*q)*T,t[1]=(i*P-r*j-a*q)*T,t[2]=(v*w-g*A+m*b)*T,t[3]=(h*A-f*w-d*b)*T,t[4]=(s*k-o*j-c*B)*T,t[5]=(e*j-i*k+a*B)*T,t[6]=(g*_-p*w-m*x)*T,t[7]=(l*w-h*_+d*x)*T,t[8]=(o*P-u*k+c*M)*T,t[9]=(r*k-e*P-a*M)*T,t[10]=(p*A-v*_+m*y)*T,t[11]=(f*_-l*A-d*y)*T,t[12]=(u*B-o*q-s*M)*T,t[13]=(e*q-r*B+i*M)*T,t[14]=(v*x-p*b-g*y)*T,t[15]=(l*b-f*x+h*y)*T,t):null},f.adjoint=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],p=n[12],v=n[13],g=n[14],m=n[15];return t[0]=u*(h*m-d*g)-f*(s*m-c*g)+v*(s*d-c*h),t[1]=-(r*(h*m-d*g)-f*(i*m-a*g)+v*(i*d-a*h)),t[2]=r*(s*m-c*g)-u*(i*m-a*g)+v*(i*c-a*s),t[3]=-(r*(s*d-c*h)-u*(i*d-a*h)+f*(i*c-a*s)),t[4]=-(o*(h*m-d*g)-l*(s*m-c*g)+p*(s*d-c*h)),t[5]=e*(h*m-d*g)-l*(i*m-a*g)+p*(i*d-a*h),t[6]=-(e*(s*m-c*g)-o*(i*m-a*g)+p*(i*c-a*s)),t[7]=e*(s*d-c*h)-o*(i*d-a*h)+l*(i*c-a*s),t[8]=o*(f*m-d*v)-l*(u*m-c*v)+p*(u*d-c*f),t[9]=-(e*(f*m-d*v)-l*(r*m-a*v)+p*(r*d-a*f)),t[10]=e*(u*m-c*v)-o*(r*m-a*v)+p*(r*c-a*u),t[11]=-(e*(u*d-c*f)-o*(r*d-a*f)+l*(r*c-a*u)),t[12]=-(o*(f*g-h*v)-l*(u*g-s*v)+p*(u*h-s*f)),t[13]=e*(f*g-h*v)-l*(r*g-i*v)+p*(r*h-i*f),t[14]=-(e*(u*g-s*v)-o*(r*g-i*v)+p*(r*s-i*u)),t[15]=e*(u*h-s*f)-o*(r*h-i*f)+l*(r*s-i*u),t},f.determinant=function(t){var n=t[0],e=t[1],r=t[2],i=t[3],a=t[4],o=t[5],u=t[6],s=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],v=t[14],g=t[15],m=n*o-e*a,y=n*u-r*a,x=n*s-i*a,_=e*u-r*o,b=e*s-i*o,A=r*s-i*u,w=c*p-l*d,M=c*v-f*d,B=c*g-h*d,k=l*v-f*p,q=l*g-h*p,P=f*g-h*v;return m*P-y*q+x*k+_*B-b*M+A*w},f.multiply=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=n[9],d=n[10],p=n[11],v=n[12],g=n[13],m=n[14],y=n[15],x=e[0],_=e[1],b=e[2],A=e[3];return t[0]=x*r+_*u+b*f+A*v,t[1]=x*i+_*s+b*h+A*g,t[2]=x*a+_*c+b*d+A*m,t[3]=x*o+_*l+b*p+A*y,x=e[4],_=e[5],b=e[6],A=e[7],t[4]=x*r+_*u+b*f+A*v,t[5]=x*i+_*s+b*h+A*g,t[6]=x*a+_*c+b*d+A*m,t[7]=x*o+_*l+b*p+A*y,x=e[8],_=e[9],b=e[10],A=e[11],t[8]=x*r+_*u+b*f+A*v,t[9]=x*i+_*s+b*h+A*g,t[10]=x*a+_*c+b*d+A*m,t[11]=x*o+_*l+b*p+A*y,x=e[12],_=e[13],b=e[14],A=e[15],t[12]=x*r+_*u+b*f+A*v,t[13]=x*i+_*s+b*h+A*g,t[14]=x*a+_*c+b*d+A*m,t[15]=x*o+_*l+b*p+A*y,t},f.mul=f.multiply,f.translate=function(t,n,e){var r,i,a,o,u,s,c,l,f,h,d,p,v=e[0],g=e[1],m=e[2];return n===t?(t[12]=n[0]*v+n[4]*g+n[8]*m+n[12],t[13]=n[1]*v+n[5]*g+n[9]*m+n[13],t[14]=n[2]*v+n[6]*g+n[10]*m+n[14],t[15]=n[3]*v+n[7]*g+n[11]*m+n[15]):(r=n[0],i=n[1],a=n[2],o=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=n[9],d=n[10],p=n[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*v+u*g+f*m+n[12],t[13]=i*v+s*g+h*m+n[13],t[14]=a*v+c*g+d*m+n[14],t[15]=o*v+l*g+p*m+n[15]),t},f.scale=function(t,n,e){var r=e[0],i=e[1],a=e[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},f.rotate=function(t,e,r,i){var a,o,u,s,c,l,f,h,d,p,v,g,m,y,x,_,b,A,w,M,B,k,q,P,j=i[0],T=i[1],C=i[2],O=Math.sqrt(j*j+T*T+C*C);return n>Math.abs(O)?null:(O=1/O,j*=O,T*=O,C*=O,a=Math.sin(r),o=Math.cos(r),u=1-o,s=e[0],c=e[1],l=e[2],f=e[3],h=e[4],d=e[5],p=e[6],v=e[7],g=e[8],m=e[9],y=e[10],x=e[11],_=j*j*u+o,b=T*j*u+C*a,A=C*j*u-T*a,w=j*T*u-C*a,M=T*T*u+o,B=C*T*u+j*a,k=j*C*u+T*a,q=T*C*u-j*a,P=C*C*u+o,t[0]=s*_+h*b+g*A,t[1]=c*_+d*b+m*A,t[2]=l*_+p*b+y*A,t[3]=f*_+v*b+x*A,t[4]=s*w+h*M+g*B,t[5]=c*w+d*M+m*B,t[6]=l*w+p*M+y*B,t[7]=f*w+v*M+x*B,t[8]=s*k+h*q+g*P,t[9]=c*k+d*q+m*P,t[10]=l*k+p*q+y*P,t[11]=f*k+v*q+x*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},f.rotateX=function(t,n,e){var r=Math.sin(e),i=Math.cos(e),a=n[4],o=n[5],u=n[6],s=n[7],c=n[8],l=n[9],f=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=a*i+c*r,t[5]=o*i+l*r,t[6]=u*i+f*r,t[7]=s*i+h*r,t[8]=c*i-a*r,t[9]=l*i-o*r,t[10]=f*i-u*r,t[11]=h*i-s*r,t},f.rotateY=function(t,n,e){var r=Math.sin(e),i=Math.cos(e),a=n[0],o=n[1],u=n[2],s=n[3],c=n[8],l=n[9],f=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*i-c*r,t[1]=o*i-l*r,t[2]=u*i-f*r,t[3]=s*i-h*r,t[8]=a*r+c*i,t[9]=o*r+l*i,t[10]=u*r+f*i,t[11]=s*r+h*i,t},f.rotateZ=function(t,n,e){var r=Math.sin(e),i=Math.cos(e),a=n[0],o=n[1],u=n[2],s=n[3],c=n[4],l=n[5],f=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=a*i+c*r,t[1]=o*i+l*r,t[2]=u*i+f*r,t[3]=s*i+h*r,t[4]=c*i-a*r,t[5]=l*i-o*r,t[6]=f*i-u*r,t[7]=h*i-s*r,t},f.fromRotationTranslation=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=r+r,s=i+i,c=a+a,l=r*u,f=r*s,h=r*c,d=i*s,p=i*c,v=a*c,g=o*u,m=o*s,y=o*c;return t[0]=1-(d+v),t[1]=f+y,t[2]=h-m,t[3]=0,t[4]=f-y,t[5]=1-(l+v),t[6]=p+g,t[7]=0,t[8]=h+m,t[9]=p-g,t[10]=1-(l+d),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},f.fromQuat=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=e+e,u=r+r,s=i+i,c=e*o,l=e*u,f=e*s,h=r*u,d=r*s,p=i*s,v=a*o,g=a*u,m=a*s;return t[0]=1-(h+p),t[1]=l+m,t[2]=f-g,t[3]=0,t[4]=l-m,t[5]=1-(c+p),t[6]=d+v,t[7]=0,t[8]=f+g,t[9]=d-v,t[10]=1-(c+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.frustum=function(t,n,e,r,i,a,o){var u=1/(e-n),s=1/(i-r),c=1/(a-o);return t[0]=2*a*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*s,t[6]=0,t[7]=0,t[8]=(e+n)*u,t[9]=(i+r)*s,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*a*c,t[15]=0,t},f.perspective=function(t,n,e,r,i){var a=1/Math.tan(n/2),o=1/(r-i);return t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*o,t[15]=0,t},f.ortho=function(t,n,e,r,i,a,o){var u=1/(n-e),s=1/(r-i),c=1/(a-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+e)*u,t[13]=(i+r)*s,t[14]=(o+a)*c,t[15]=1,t},f.lookAt=function(t,e,r,i){var a,o,u,s,c,l,h,d,p,v,g=e[0],m=e[1],y=e[2],x=i[0],_=i[1],b=i[2],A=r[0],w=r[1],M=r[2];return n>Math.abs(g-A)&&n>Math.abs(m-w)&&n>Math.abs(y-M)?f.identity(t):(h=g-A,d=m-w,p=y-M,v=1/Math.sqrt(h*h+d*d+p*p),h*=v,d*=v,p*=v,a=_*p-b*d,o=b*h-x*p,u=x*d-_*h,v=Math.sqrt(a*a+o*o+u*u),v?(v=1/v,a*=v,o*=v,u*=v):(a=0,o=0,u=0),s=d*u-p*o,c=p*a-h*u,l=h*o-d*a,v=Math.sqrt(s*s+c*c+l*l),v?(v=1/v,s*=v,c*=v,l*=v):(s=0,c=0,l=0),t[0]=a,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=p,t[11]=0,t[12]=-(a*g+o*m+u*y),t[13]=-(s*g+c*m+l*y),t[14]=-(h*g+d*m+p*y),t[15]=1,t)},f.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},t!==void 0&&(t.mat4=f);var h={};h.create=function(){var t=new e(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.rotationTo=function(){var t=o.create(),n=o.fromValues(1,0,0),e=o.fromValues(0,1,0);return function(r,i,a){var u=o.dot(i,a);return-.999999>u?(o.cross(t,n,i),1e-6>o.length(t)&&o.cross(t,e,i),o.normalize(t,t),h.setAxisAngle(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,h.normalize(r,r))}}(),h.setAxes=function(){var t=l.create();return function(n,e,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=e[0],t[5]=e[1],t[8]=e[2],h.normalize(n,h.fromMat3(n,t))}}(),h.clone=u.clone,h.fromValues=u.fromValues,h.copy=u.copy,h.set=u.set,h.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.setAxisAngle=function(t,n,e){e=.5*e;var r=Math.sin(e);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(e),t},h.add=u.add,h.multiply=function(t,n,e){var r=n[0],i=n[1],a=n[2],o=n[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=r*l+o*u+i*c-a*s,t[1]=i*l+o*s+a*u-r*c,t[2]=a*l+o*c+r*s-i*u,t[3]=o*l-r*u-i*s-a*c,t},h.mul=h.multiply,h.scale=u.scale,h.rotateX=function(t,n,e){e*=.5;var r=n[0],i=n[1],a=n[2],o=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=a*s-i*u,t[3]=o*s-r*u,t},h.rotateY=function(t,n,e){e*=.5;var r=n[0],i=n[1],a=n[2],o=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s-a*u,t[1]=i*s+o*u,t[2]=a*s+r*u,t[3]=o*s-i*u,t},h.rotateZ=function(t,n,e){e*=.5;var r=n[0],i=n[1],a=n[2],o=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=a*s+o*u,t[3]=o*s-a*u,t},h.calculateW=function(t,n){var e=n[0],r=n[1],i=n[2];return t[0]=e,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-e*e-r*r-i*i)),t},h.dot=u.dot,h.lerp=u.lerp,h.slerp=function(t,n,e,r){var i,a,o,u,s,c=n[0],l=n[1],f=n[2],h=n[3],d=e[0],p=e[1],v=e[2],g=e[3];return a=c*d+l*p+f*v+h*g,0>a&&(a=-a,d=-d,p=-p,v=-v,g=-g),1-a>1e-6?(i=Math.acos(a),o=Math.sin(i),u=Math.sin((1-r)*i)/o,s=Math.sin(r*i)/o):(u=1-r,s=r),t[0]=u*c+s*d,t[1]=u*l+s*p,t[2]=u*f+s*v,t[3]=u*h+s*g,t},h.invert=function(t,n){var e=n[0],r=n[1],i=n[2],a=n[3],o=e*e+r*r+i*i+a*a,u=o?1/o:0;return t[0]=-e*u,t[1]=-r*u,t[2]=-i*u,t[3]=a*u,t},h.conjugate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t},h.length=u.length,h.len=h.length,h.squaredLength=u.squaredLength,h.sqrLen=h.squaredLength,h.normalize=u.normalize,h.fromMat3=function(){var t="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0];return function(n,e){var r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),n[3]=.5*r,r=.5/r,n[0]=(e[7]-e[5])*r,n[1]=(e[2]-e[6])*r,n[2]=(e[3]-e[1])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=t[a],u=t[o];r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*u+u]+1),n[a]=.5*r,r=.5/r,n[3]=(e[3*u+o]-e[3*o+u])*r,n[o]=(e[3*o+a]+e[3*a+o])*r,n[u]=(e[3*u+a]+e[3*a+u])*r}return n}}(),h.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.quat=h)}(n.exports)}(this),r("2d/style",["require","core/base","_"],function(t){function n(t){return(t||"").replace(/^(\s|\u00A0)+|(\s|\u00A0)+$/g,"")}var e=t("core/base"),r=t("_"),i=["fillStyle","strokeStyle","lineWidth","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","globalAlpha","font"],a={fill:"fillStyle",stroke:"strokeStyle",alpha:"globalAlpha",shadow:["shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor"]},o=/([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([a-zA-Z0-9\(\)\s,#]+)/,u=e.derive({},{bind:function(t){var e=i,u=a;for(var s in u)if(this.hasOwnProperty(s)){var c=u[s],l=this[s];if("shadow"==s){var f=o.exec(n(l));if(!f)continue;l=f.slice(1),r.each(l,function(n,e){c[e]&&(t[c[e]]=n)},this)}else t[c]=l}r.each(e,function(n){this.hasOwnProperty(n)&&(t[n]=this[n])},this)}});return u}),r("2d/node",["require","core/base","glmatrix","./style"],function(t){var n=t("core/base"),e=t("glmatrix"),r=e.vec2,i=e.mat2d,a=t("./style"),o=n.derive(function(){return{__mouseover__:!1,id:0,AABB:[r.fromValues(0,0),r.fromValues(0,0)],z:0,style:null,position:r.fromValues(0,0),rotation:0,scale:r.fromValues(1,1),_transform:i.create(),_transformInverse:i.create(),visible:!0,children:{},intersectLineWidth:0,clip:!1,fill:!0,stroke:!0,fixAA:!0}},function(){this.__GUID__=u()},{updateTransform:function(){var t=this._transform;return i.identity(t),this.scale&&i.scale(t,t,this.scale),this.rotation&&i.rotate(t,t,this.rotation),this.position&&i.translate(t,t,this.position),t},updateTransformInverse:function(){i.invert(this._transformInverse,this._transformInverse)},intersectAABB:function(t,n){var e=this.AABB;return t>e[0][0]&&e[1][0]>t&&n>e[0][1]&&e[1][1]>n},add:function(t){t&&(this.children[t.__GUID__]=t,t.parent=this)},remove:function(t){this.children[t.__GUID__]=null,t.parent=null},draw:function(){},render:function(t){var n=this._getSortedRenderQueue();if(t.save(),this.style)if(!this.style instanceof a)for(var e in this.style)this.style[e].bind(t);else this.style.bind(t);var r=this.updateTransform();t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.draw(t),this.clip&&t.clip();for(var i=0;n.length>i;i++)n[i].render(t);t.restore()},traverse:function(t){var n=t&&t(this);if(!n)for(var e=this.children,r=0,i=e.length;i>r;r++)e[r].traverse(t)},intersect:function(){},_getSortedRenderQueue:function(){var t=[];for(var n in this.children)t.push(this.children[n]);return t.sort(function(t,n){return t.z===n.z?t.__GUID__>n.__GUID__?1:-1:t.z>n.z?1:-1}),t}}),u=function(){var t=0;return function(){return++t}}();return o}),r("2d/util",["require"],function(){return{fixPos:function(t){return[t[0]+.5,t[1]+.5]},fixPosArray:function(t){for(var n=[],e=t.length,r=0;e>r;r++)n.push(this.fixPos(t[r]));return n},computeAABB:function(t){for(var n=t[0][0],e=t[0][0],r=t[0][1],i=t[0][1],a=1;t.length>a;a++)n=n>t[a][0]?t[a][0]:n,e=t[a][0]>e?t[a][0]:e,r=r>t[a][1]?t[a][1]:r,i=t[a][1]>i?t[a][1]:i;return[[n,r],[e,i]]}}}),r("2d/renderable/arc",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix");r.vec2;var i=n.derive(function(){return{center:[0,0],radius:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0}},{computeAABB:function(){this.AABB=[[0,0],[0,0]]},draw:function(){var t=this.fixAA?e.fixPos(this.center):this.center;ctx.beginPath(),ctx.arc(t[0],t[1],this.radius,this.startAngle,this.endAngle,!this.clockwise),this.stroke&&ctx.stroke(),this.fill&&ctx.fill()},intersect:function(){return!1}});return i}),r("2d/renderable/circle",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix"),i=r.vec2,a=n.derive(function(){return{center:[0,0],radius:0}},{computeAABB:function(){this.AABB=[[this.center[0]-this.radius,this.center[1]-this.radius],[this.center[0]+this.radius,this.center[1]+this.radius]]},draw:function(t){var n=this.fixAA?e.fixPos(this.center):this.center;t.beginPath(),t.arc(n[0],n[1],this.radius,0,2*Math.PI,!1),this.stroke&&t.stroke(),this.fill&&t.fill()},intersect:function(){return i.len([this.center[0]-x,this.center[1]-y])<this.radius}});return a}),r("2d/renderable/image",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix");r.vec2;var i={},a=n.derive(function(){return{img:"",start:[0,0],size:0,onload:function(){}}},function(){if("string"==typeof this.img){var t=this;this.load(this.img,function(n){t.img=n,t.onload.call(t)})}},{computeAABB:function(){this.AABB=e.computeAABB([this.start,[this.start[0]+this.size[0],this.start[1]+this.size[1]]])},draw:function(t){var n=this.fixAA?e.fixPos(this.start):this.start;"string"!=typeof this.img&&(this.size?t.drawImage(this.img,n[0],n[1],this.size[0],this.size[1]):t.drawImage(this.img,n[0],n[1]))},intersect:function(t,n){return this.intersectAABB(t,n)},load:function(t,n){if(i[t]){var e=i[t];e.constructor==Array?e.push(n):n(e)}else{i[t]=[n];var e=new a;e.onload=function(){each(i[t],function(t){t(e)}),i[t]=e},e.src=t}}});return a}),r("2d/renderable/line",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix"),i=r.vec2,a=n.derive(function(){return{start:[0,0],end:[0,0],width:0}},{computeAABB:function(){this.AABB=e.computeAABB([this.start,this.end]),this.AABB[0][0]==this.AABB[1][0]&&(this.AABB[0][0]-=this.width/2,this.AABB[1][0]+=this.width/2),this.AABB[0][1]==this.AABB[1][1]&&(this.AABB[0][1]-=this.width/2,this.AABB[1][1]+=this.width/2)},draw:function(t){var n=this.fixAA?e.fixPos(this.start):this.start,r=this.fixAA?e.fixPos(this.end):this.end;t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(r[0],r[1]),t.stroke()},intersect:function(t,n){if(!this.intersectAABB(t,n))return!1;var e=[t,n];b=this.start,c=this.end,ba=i.sub([],e,b),bc=i.sub([],c,b);var r=i.dot(bc,ba);i.normalize(bc,bc);var a=i.add(b,i.scale(bc,r)),o=i.length(i.sub(e,e,a));return this.width/2>o}});return a}),r("2d/renderable/path",["require","../node","../util","glmatrix"],function(t){var n=t("../node");t("../util");var e=t("glmatrix"),r=e.vec2,i=n.derive(function(){return{segments:[],globalStyle:!0}},{computeAABB:function(){this.AABB=[[0,0],[0,0]]},draw:function(t){this.globalStyle?this.drawWithSameStyle(t):this.drawWithDifferentStyle(t)},drawWithSameStyle:function(t){var n=this.segments.length,e=this.segments;t.beginPath(),t.moveTo(e[0].point[0],e[0].point[1]);for(var r=1;n>r;r++)if(e[r-1].handleOut||e[r].handleIn){var i=e[r-1].handleOut||e[r-1].point,a=e[r].handleIn||e[r].point;t.bezierCurveTo(i[0],i[1],a[0],a[1],e[r].point[0],e[r].point[1])}else t.lineTo(e[r].point[0],e[r].point[1]);this.fill&&t.fill(),this.stroke&&t.stroke()},drawWithDifferentStyle:function(t){for(var n=this.segments.length,e=this.segments,r=0;n-1>r;r++){if(t.save(),e[r].style&&e[r].style.bind(t),t.beginPath(),t.moveTo(e[r].point[0],e[r].point[1]),e[r].handleOut||e[r+1].handleIn){var i=e[r].handleOut||e[r].point,a=e[r+1].handleIn||e[r+1].point;t.bezierCurveTo(i[0],i[1],a[0],a[1],e[r+1].point[0],e[r+1].point[1])}else t.lineTo(e[r+1].point[0],e[r+1].point[1]);this.stroke&&t.stroke(),this.fill&&t.fill(),t.restore()}},smooth:function(t){function n(t,n,e){var i=r.scale([],r.add([],n,e),.5);return r.sub([],t,i)}for(var e=this.segments.length,i=[],a=this.segments,o=0;e>o;o++){var u=a[o].point,s=o==e-1?a[0].point:a[o+1].point;i.push(r.scale([],r.add([],u,s),.5))}for(var o=0;e>o;o++){var u=a[o].point,c=i[o],l=0==o?i[e-1]:i[o-1],t=a[o].smoothLevel||t||1,f=r.scale([],r.add([],c,l),.5),h=r.sub([],c,f),d=r.sub([],l,f),p=n(u,l,c);r.scale(d,d,t),r.scale(h,h,t),a[o].handleIn=r.add([],r.add([],f,d),p),a[o].handleOut=r.add([],r.add([],f,h),p)}a[0].handleOut=a[0].handleIn=null,a[e-1].handleIn=a[e-1].handleOut=null},pushPoints:function(t){for(var n=0;t.length>n;n++)this.segments.push({point:t[n],handleIn:null,handleOut:null})}});return i}),r("2d/renderable/polygon",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix");return r.vec2,n.derive(function(){return{points:[]}},{computeAABB:function(){this.AABB=e.computeAABB(this.points)},draw:function(t){var n=this.fixAA?e.fixPosArray(this.points):this.points;t.beginPath(),t.moveTo(n[0][0],n[0][1]);for(var r=1;n.length>r;r++)t.lineTo(n[r][0],n[r][1]);t.closePath(),this.stroke&&t.stroke(),this.fill&&t.fill()},intersect:function(t,n){if(!this.intersectAABB(t,n))return!1;for(var e,r,i,a,o=this.points.length,u=0,s=this.points,c=0;o>c;c++)e=r.normalize([],[s[c][0]-t,s[c][1]-n]),i=(c+1)%o,r=r.normalize([],[s[i][0]-t,s[i][1]-n]),a=Math.acos(r.dot(e,r)),u+=a;
return.001>Math.length(u-2*Math.PI)}}),n}),r("2d/renderable/rectangle",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix"),i=r.vec2,a=n.derive(function(){return{start:[0,0],size:[0,0]}},{computeAABB:function(){var t=i.add([],this.start,this.size);this.AABB=e.computeAABB([this.start,t])},draw:function(t){var n=this.fixAA?e.fixPos(this.start):this.start;t.beginPath(),t.rect(n[0],n[1],this.size[0],this.size[1]),this.stroke&&t.stroke(),this.fill&&t.fill()},intersect:function(t,n){return this.intersectAABB(t,n)}});return a}),r("2d/renderable/roundedrectangle",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix"),i=r.vec2,a=n.derive(function(){return{start:[0,0],size:[0,0],radius:0}},{computeAABB:function(){var t=i.add([],this.start,this.size);this.AABB=e.computeAABB([this.start,t])},draw:function(t){if(this.radius.constructor==Number)var n=[this.radius,this.radius,this.radius,this.radius];else if(2==this.radius.length)var n=[this.radius[0],this.radius[1],this.radius[0],this.radius[1]];else var n=this.radius;var r=this.fixAA?e.fixPos(this.start):this.start,a=this.size,o=i.add([],r,[n[0],0]),u=i.add([],r,[a[0],0]),s=i.add([],r,a),c=i.add([],r,[0,a[1]]);t.beginPath(),t.moveTo(o[0],o[1]),n[1]?t.arcTo(u[0],u[1],s[0],s[1],n[1]):t.lineTo(u[0],u[1]),n[2]?t.arcTo(s[0],s[1],c[0],c[1],n[2]):t.lineTo(s[0],s[1]),n[3]?t.arcTo(c[0],c[1],r[0],r[1],n[3]):t.lineTo(c[0],c[1]),n[0]?t.arcTo(r[0],r[1],u[0],u[1],n[0]):t.lineTo(r[0],r[1]),this.stroke&&t.stroke(),this.fill&&t.fill()},intersect:function(){return!1}});return a}),r("2d/renderable/sector",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix"),i=r.vec2,a=n.derive(function(){return{center:[0,0],innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,clockwise:!0}},{computeAABB:function(){this.AABB=[0,0]},intersect:function(t,n){var e=this.startAngle,r=this.endAngle,a=this.innerRadius,o=this.outerRadius,u=this.center,s=i.sub([],[t,n],u),c=i.length(s),l=2*Math.PI;if(a>c||c>o)return!1;var f=Math.atan2(s[1],s[0]);return 0>f&&(f+=l),this.clockwise?r>f&&f>e:(e=l-e,r=l-r,f>r&&e>f)},draw:function(t){var n=this.startAngle,r=this.endAngle,a=this.innerRadius,o=this.outerRadius,u=this.fixAA?e.fixPos(this.center):this.center;this.clockwise||(n=2*Math.PI-n,r=2*Math.PI-r);var s=i.add([],u,[a*Math.cos(n),a*Math.sin(n)]),c=i.add([],u,[o*Math.cos(n),o*Math.sin(n)]),l=i.add([],u,[a*Math.cos(r),a*Math.sin(r)]);i.add([],u,[o*Math.cos(r),o*Math.sin(r)]),t.beginPath(),t.moveTo(s[0],s[1]),t.lineTo(c[0],c[1]),t.arc(u[0],u[1],o,n,r,!this.clockwise),t.lineTo(l[0],l[1]),t.arc(u[0],u[1],a,r,n,this.clockwise),t.endPath(),this.stroke&&t.stroke(),this.fill&&t.fill()}});return a}),r("2d/renderable/text",["require","../node","../util","glmatrix"],function(t){var n=t("../node"),e=t("../util"),r=t("glmatrix");r.vec2;var i=n.derive(function(){return{text:"",start:[0,0],size:[0,0],font:"",textAlign:"",textBaseline:""}},{computeAABB:function(){this.AABB=e.computeAABB([this.start,[this.start[0]+this.size[0],this.start[1]+this.size[1]]])},draw:function(t){var n=this.fixAA?e.fixPos(this.start):this.start;this.font&&(t.font=this.font),this.textAlign&&(t.textAlign=this.textAlign),this.textBaseline&&(t.textBaseline=this.textBaseline),this.fill&&(this.size.length&&this.size[0]?t.fillText(this.text,n[0],n[1],this.size[0]):t.fillText(this.text,n[0],n[1])),this.stroke&&(this.size.length&&this.size[0]?t.strokeText(this.text,n[0],n[1],this.size[0]):t.strokeText(this.text,n[0],n[1]))},resize:function(t){(!this.size[0]||this.needResize)&&(this.size[0]=t.measureText(this.text).width,this.size[1]=t.measureText("m").width)},intersect:function(t,n){return this.intersectAABB(t,n)}});return i}),r("2d/renderable/textbox",["require","../node","../util","glmatrix","./text","_"],function(t){var n=t("../node");t("../util");var e=t("glmatrix"),r=e.vec2,i=t("./text"),a=t("_"),o=n.derive(function(){return{text:"",textAlign:"",textBaseline:"top",font:"",start:[0,0],width:0,wordWrap:!1,wordBreak:!1,lineHeight:0,stroke:!1,_texts:[]}},function(){this._oldText=""},{computeAABB:function(){},draw:function(t){if(this.text!=this._oldText)if(this._oldText=this.text,this.font&&(t.font=this.font),this.wordBreak)this._texts=this.computeWordBreak(t);else if(this.wordWrap)this._texts=this.computeWordWrap(t);else{var n=new i({text:this.text,textBaseline:this.textBaseline});this.extendCommonProperties(n),this._texts=[n]}a.each(this._texts,function(n){n.draw(t)})},computeWordWrap:function(t){if(this.text){for(var n,e,a,o=this.text.split(" "),u=o.length,s=0,c=[],l=0;u>l;l++)e=l==u-1?o[l]:o[l]+" ",n=t.measureText(e).width,s+n>this.width||!a?(a=new i({text:e,start:r.add([],this.start,[0,this.lineHeight*c.length])}),this.extendCommonProperties(a),c.push(a),s=n):(s+=n,a.text+=e);return c}},computeWordBreak:function(t){if(this.text){for(var n,e,a,o=this.text.length,u=t.measureText(this.text[0]).width,s=[],c=0;o>c;c++)if(e=this.text[c],n=t.measureText(e).width,u+n>this.width||!a){var a=new i({text:e,start:r.add([],this.start,[0,this.lineHeight*s.length])});this.extendCommonProperties(a),s.push(a),u=n}else u+=n,a.text+=e;return s}},extendCommonProperties:function(t){a.extend(t,{textAlign:this.textAlign,textBaseline:this.textBaseline,style:this.style,font:this.font,fill:this.fill,stroke:this.stroke})},intersect:function(){}});return o}),r("2d/renderer",["require","core/base"],function(t){var n=t("core/base"),e=n.derive(function(){return{canvas:null,context:null,width:0,height:0,_latestRenderedScene:null}},function(){this.canvas||(this.canvas=document.createElement("canvas")),this.canvas.addEventListener("click",this._clickHandler.bind(this)),this.canvas.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this.canvas.addEventListener("mouseup",this._mouseUpHandler.bind(this)),this.canvas.addEventListener("mousemove",this._mouseMoveHandler.bind(this)),this.canvas.addEventListener("mouseout",this._mouseOutHandler.bind(this)),this.width?this.canvas.width=this.width:this.width=this.canvas.width,this.height?this.canvas.height=this.height:this.height=this.canvas.height,this.context=this.canvas.getContext("2d")},{resize:function(t,n){this.canvas.width=t,this.canvas.height=n},render:function(t){this.context.clearRect(0,0,this.width,this.height),t.render(this.context),this._latestRenderedScene=t},_clickHandler:function(){this._latestRenderedScene},_mouseDownHandler:function(){},_mouseUpHandler:function(){},_mouseMoveHandler:function(){},_mouseOutHandler:function(){}});return e}),r("2d/scene",["require","./node"],function(t){var n=t("./node"),e=n.derive(function(){return{}},{});return e}),r("core/event",["require","./base"],function(t){var n=t("./base"),e=n.derive({cancelBubble:!1},{stopPropagation:function(){this.cancelBubble=!0}});e.throw=function(t,n,e){var r=new MouseEvent(e);for(r.sourceTarget=n;n&&!r.cancelBubble;)r.target=n,n.trigger(t,r),n=n.parent}}),r("core/quaternion",["require","glmatrix"],function(t){var n=t("glmatrix"),e=n.quat,r=function(t,n,r,a){return t=t||0,n=n||0,r=r||0,a=a||1,Object.create(i,{x:{configurable:!1,set:function(t){this._array[0]=t,this._dirty=!0},get:function(){return this._array[0]}},y:{configurable:!1,set:function(t){this._array[1]=t,this._dirty=!0},get:function(){return this._array[1]}},z:{configurable:!1,set:function(t){this._array[2]=t,this._dirty=!0},get:function(){return this._array[2]}},w:{configurable:!1,set:function(t){this._array[2]=t,this._dirty=!0},get:function(){return this._array[2]}},_array:{writable:!1,configurable:!1,value:e.fromValues(t,n,r,a)},_dirty:{configurable:!1,value:!1}})},i={constructor:r,add:function(t){return e.add(this._array,this._array,t._array),this},calculateW:function(){e.calculateW(this._array,this._array)},set:function(t,n,e,r){this.x=t,this.y=n,this.z=e,this.w=r},clone:function(){return new r(this.x,this.y,this.z,this.w)},conjugate:function(){return e.conjugate(this._array,this._array),this},copy:function(t){return e.copy(this._array,t._array),this},dot:function(t){return e.dot(this._array,t._array)},fromMat3:function(t){return e.fromMat3(this._array,t._array),this},fromMat4:function(){var t=n.mat3,r=t.create();return function(n){return t.fromMat4(r,n._array),t.transpose(r,r),e.fromMat3(this._array,r),this}}(),identity:function(){return e.identity(this._array),this},invert:function(){return e.invert(this._array,this._array),this},len:function(){return e.len(this._array)},length:function(){return e.length(this._array)},lerp:function(t,n,r){return e.lerp(this._array,t._array,n._array,r),this},mul:function(t){return e.mul(this._array,this._array,t._array),this},multiply:function(t){return e.multiply(this._array,this._array,t._array),this},normalize:function(){return e.normalize(this._array,this._array),this},rotateX:function(t){e.rotateX(this._array,this._array,t)},rotateY:function(t){e.rotateY(this._array,this._array,t)},rotateZ:function(t){e.rotateZ(this._array,this._array,t)},setAxisAngle:function(t,n){e.setAxisAngle(this._array,t._array,n)},sqrLen:function(){return e.sqrLen(this._array)},squaredLength:function(){return e.squaredLength(this._array)},setFromEuler:function(){},toString:function(){return"["+Array.prototype.join.call(this._array,",")+"]"}};return r}),r("core/request",["require"],function(){function t(t){var n=new XMLHttpRequest;n.open("get",t.url),n.responseType=t.responseType||"text",t.onprogress&&(n.onprogress=function(n){if(n.lengthComputable){var e=n.loaded/n.total;t.onprogress(e,n.loaded,n.total)}else t.onprogress(null)}),n.onload=function(){t.onload&&t.onload(n.response)},t.onerror&&(n.onerror=t.onerror),n.send(null)}function n(){}return{get:t,put:n}}),r("core/vector2",function(){}),r("text",["module"],function(t){var n,r,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,s=u&&location.protocol&&location.protocol.replace(/\:/,""),c=u&&location.hostname,l=u&&(location.port||void 0),f=[],h=t.config&&t.config()||{};return n={version:"2.0.5",strip:function(t){if(t){t=t.replace(a,"");var n=t.match(o);n&&(t=n[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var t,n,e;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(n=0;3>n;n+=1){e=i[n];try{t=new ActiveXObject(e)}catch(r){}if(t){i=[e];break}}return t},parseName:function(t){var n,e,r,i=!1,a=t.indexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!o||a>1)?(n=t.substring(0,a),e=t.substring(a+1,t.length)):n=t,r=e||n,a=r.indexOf("!"),-1!==a&&(i="strip"===r.substring(a+1),r=r.substring(0,a),e?e=r:n=r),{moduleName:n,ext:e,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,r,i){var a,o,u,s=n.xdRegExp.exec(t);return s?(a=s[2],o=s[3],o=o.split(":"),u=o[1],o=o[0],!(a&&a!==e||o&&o.toLowerCase()!==r.toLowerCase()||(u||o)&&u!==i)):!0},finishLoad:function(t,e,r,i){r=e?n.strip(r):r,h.isBuild&&(f[t]=r),i(r)},load:function(t,e,r,i){if(i.isBuild&&!i.inlineText)return r(),void 0;h.isBuild=i.isBuild;var a=n.parseName(t),o=a.moduleName+(a.ext?"."+a.ext:""),f=e.toUrl(o),d=h.useXhr||n.useXhr;!u||d(f,s,c,l)?n.get(f,function(e){n.finishLoad(t,a.strip,e,r)},function(t){r.error&&r.error(t)}):e([o],function(t){n.finishLoad(a.moduleName+"."+a.ext,a.strip,t,r)})},write:function(t,e,r){if(f.hasOwnProperty(e)){var i=n.jsEscape(f[e]);r.asModule(t+"!"+e,"define(function () { return '"+i+"';});\n")}},writeFile:function(t,e,r,i,a){var o=n.parseName(e),u=o.ext?"."+o.ext:"",s=o.moduleName+u,c=r.toUrl(o.moduleName+u)+".js";n.load(s,r,function(){var e=function(t){return i(c,t)};e.asModule=function(t,n){return i.asModule(t,c,n)},n.write(t,s,e,a)},a)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(r=e.nodeRequire("fs"),n.get=function(t,n){var e=r.readFileSync(t,"utf8");0===e.indexOf("")&&(e=e.substring(1)),n(e)}):"xhr"===h.env||!h.env&&n.createXhr()?n.get=function(t,e,r,i){var a,o=n.createXhr();if(o.open("GET",t,!0),i)for(a in i)i.hasOwnProperty(a)&&o.setRequestHeader(a.toLowerCase(),i[a]);h.onXhr&&h.onXhr(o,t),o.onreadystatechange=function(){var n,i;4===o.readyState&&(n=o.status,n>399&&600>n?(i=Error(t+" HTTP status: "+n),i.xhr=o,r(i)):e(o.responseText))},o.send(null)}:("rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(n.get=function(t,n){var e,r,i="utf-8",a=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),i)),s="";try{for(e=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),e.append(r);null!==(r=u.readLine());)e.append(o),e.append(r);s=""+e+""}finally{u.close()}n(s)}),n}),r("util/color",["require"],function(){}),r("util/util",["require"],function(){return{genGUID:function(){var t=0;return function(){return++t}}()}}),r("util/xmlparser",["require"],function(){}),r("src/qtek2d.js",["require","2d/camera","2d/node","2d/renderable/arc","2d/renderable/circle","2d/renderable/image","2d/renderable/line","2d/renderable/path","2d/renderable/polygon","2d/renderable/rectangle","2d/renderable/roundedrectangle","2d/renderable/sector","2d/renderable/text","2d/renderable/textbox","2d/renderer","2d/scene","2d/style","2d/util","core/base","core/cache","core/event","core/mixin/derive","core/mixin/dirty","core/mixin/notifier","core/quaternion","core/request","core/vector2","text","util/color","util/util","util/xmlparser","glmatrix"],function(t){var n={"2d":{Camera:t("2d/camera"),Node:t("2d/node"),renderable:{Arc:t("2d/renderable/arc"),Circle:t("2d/renderable/circle"),Image:t("2d/renderable/image"),Line:t("2d/renderable/line"),Path:t("2d/renderable/path"),Polygon:t("2d/renderable/polygon"),Rectangle:t("2d/renderable/rectangle"),RoundedRectangle:t("2d/renderable/roundedrectangle"),Sector:t("2d/renderable/sector"),Text:t("2d/renderable/text"),TextBox:t("2d/renderable/textbox")},Renderer:t("2d/renderer"),Scene:t("2d/scene"),Style:t("2d/style"),util:t("2d/util")},core:{Base:t("core/base"),Cache:t("core/cache"),Event:t("core/event"),mixin:{derive:t("core/mixin/derive"),Dirty:t("core/mixin/dirty"),notifier:t("core/mixin/notifier")},Quaternion:t("core/quaternion"),requester:t("core/request"),Vector2:t("core/vector2")},loader:{},Text:t("text"),util:{Color:t("util/color"),Util:t("util/util"),Xmlparser:t("util/xmlparser")}},e=t("glmatrix");return n.math=e,n});var i=e("src/qtek");for(var a in i)t[a]=i[a]});